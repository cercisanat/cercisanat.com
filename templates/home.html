{% extends "base.html" %}
{% load thumbnail %}
{% load author %}
{% load static from staticfiles %}
{% block head %}
  {{ block.super }}
  <script type="text/javascript" src="{% static "js/cerci_slider.js" %}"></script>
  <script type="text/javascript" src="{% static "js/responsive/home.js" %}"></script>
  <script type="text/javascript">
  $(document).ready(function() {
    //Slider is buggy
    /*$('.journal').cerciSlider({first_issue: {{ first.number }},
                               last_issue: {{ last.number }},
                               prev: "{% url 'home_year' year=year|add:'-1' %}", 
                               next: "{% url 'home_year' year=year|add:'1' %}"});*/
  });
  </script>
  <link rel="stylesheet" href="{% static "css/home.css" %}" type="text/css"/>
  <link rel="stylesheet" href="{% static "css/cerciSlider.css" %}" type="text/css"/>
{% endblock %}

{% block content %}
    <div id="random-contents" class="carousel slide">
        <ol class="carousel-indicators">
            {% for i in rand %}
            <li data-target="#random-contents" data-slide-to="{{ forloop.counter0 }}" {% if forloop.first %}class="active"{% endif %}></li>
            {% endfor %}
        </ol>
        <!-- Carousel items -->
        <div class="carousel-inner">
            {% for i in rand %}
            <div class="{% if forloop.first %}active {% endif %}item row">
                <div class="pull-left span3">
                <img src="{{ i.figures.get.image|thumbnail_url:'slider_image' }}" />
                </div>
                <div class="pull-left span3">
                    <h1>{{ i.title }}</h1>
                    <h1>{{ i.authors.all|author_list|safe }}</h1>
                </div>
                <div class="clearfix"></div>
            </div>
            {% endfor %}
        </div>
        <!-- Carousel nav -->
        <a class="carousel-control left" href="#random-contents" data-slide="prev">&lsaquo;</a>
        <a class="carousel-control right" href="#random-contents" data-slide="next">&rsaquo;</a>
    </div>

<div class="years clearfix">
  {% if first_year != year %} 
    <a class="prev" href="{% url 'home_year' year=year|add:'-1' %}">{{ year|add:"-1" }}</a>
  {% endif %}
  <span class="now">{{ year }}</span>
  {% if last_year != year %} 
    <a class="next" href="{% url 'home_year' year=year|add:'1' %}">{{ year|add:"1" }}</a>
  {% endif %}
</div>

<div class="journal clearfix">
<section class="issues_wrapper">
  {% for issue in issues %}
  <section class="issue clearfix">
    <h1 id="issue-{{ issue.number }}" class="number">
      <a href="{% url 'current_issue' issue_number=issue.number %}">Sayı {{ issue.number }}, {{ issue.published_at|date:"F" }}</a></h1>
    <a href="{% url 'current_issue' issue_number=issue.number %}">
      <img class="cover" src="{{ issue.cover|thumbnail_url:'cover' }}" alt="Kapak Resmi" title="Kapak Resmi" />
    </a>
    <section class="contents">
      <ul class="unstyled">
      {% for issue2content in issue.issue2content_set.all %}
        {% with issue2content.content as content %}
          {% if content.is_published %}
          <li>
            <strong><a href="{% url 'current_issuecontent' issue_number=issue.number contentslug=content.slug %}">{{ content.title }}</a></strong><br/>
            <em>{{ content.authors.all|author_list|safe }}</em>
          </li>
          {% endif %}
        {% endwith %}
      {% endfor %}
      </ul>
    </section>
  </section>
  {% endfor %}
  </section>
  <div class="cerciSlider clearfix">
    <div class="inner"></div>
    <a class="prev" href="#prev">Önceki Sayı</a>
    <a class="next" href="#next">Sonraki Sayı</a>
  </div>
</div>
{% endblock %}
